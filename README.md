# Anonimizator

Anonimizator — локальный веб-сервис для анонимизации и псевдоанонимизации Excel-таблиц с помощью токенизации. Сервис предназначен для подготовки данных к обработке системами искусственного интеллекта и анализа, обеспечивая защиту персональных и конфиденциальных данных.

Все операции выполняются полностью в браузере пользователя, без отправки данных на сервер. Сервис не требует регистрации, не использует внешние API и предоставляется бесплатно. Данные обрабатываются локально в памяти браузера, что обеспечивает высокий уровень конфиденциальности и безопасности.

Сервис ориентирован на работу с персональными данными, чувствительной информацией и конфиденциальными материалами, которые необходимо обезличить перед передачей на обработку внешним системам, включая нейросети и сервисы искусственного интеллекта.

---

## Ключевая идея и принцип работы

### Что такое псевдоанонимизация

Псевдоанонимизация — это процесс замены идентифицирующих данных на токены (случайные идентификаторы), которые не несут исходного смысла и не связаны с данными вычислимым образом. В отличие от необратимого шифрования, псевдоанонимизация позволяет восстановить исходные данные при наличии специального словаря соответствий.

### Принцип токенизации

Сервис использует метод токенизации для псевдоанонимизации данных:

- **Токен** — это случайный идентификатор, генерируемый криптографически стойким способом. Токен представляет собой строку вида `[[base64url-строка]]`, где base64url-строка — это случайная последовательность символов, не несущая информации об исходных данных.

- **Единая токенизация**: одинаковые значения в рамках одной сессии токенизации получают одинаковый токен. Это обеспечивает сохранение связей между данными при сохранении их анонимности.

- **Отсутствие паттернов**: токены не содержат префиксов, суффиксов или других признаков, указывающих на тип данных или исходное значение. Токены не привязаны к типу данных и не несут смысловой нагрузки.

- **Необратимость без словаря**: по токену невозможно восстановить исходное значение без словаря соответствий. Токены генерируются с использованием криптографически стойкого генератора случайных чисел (`crypto.getRandomValues()`), что делает перебор практически невозможным.

### Словарь токенов

Словарь токенов — это JSON-файл, содержащий пары соответствий "токен → исходное значение". Словарь является единственным способом обратного восстановления данных из токенов. Без словаря восстановление данных невозможно.

**Важно**: сервис не шифрует данные в классическом смысле, а именно токенизирует их. Это означает, что при наличии словаря данные полностью восстанавливаются, а без словаря — практически невосстановимы.

---

## Безопасность и конфиденциальность

### Локальная обработка данных

Все операции выполняются исключительно в браузере пользователя:

- Обработка файлов происходит локально в памяти браузера
- Токенизация выполняется на стороне клиента
- Детокенизация выполняется на стороне клиента
- Сервис не использует внешние API
- Сервис не делает сетевые запросы для обработки данных
- Данные не передаются на сервер и не сохраняются на сервере

### Отсутствие серверной части

Сервис является статическим веб-приложением и не имеет серверной части. Это означает:

- Нет серверной обработки данных
- Нет базы данных для хранения информации
- Нет внешних зависимостей для обработки данных
- Безопасность обеспечивается локальной обработкой и изоляцией данных в браузере

### Безопасность словаря

Словарь токенов является ключевым элементом безопасности системы:

- **Потеря словаря = невозможность восстановления данных**: без словаря соответствий токены не могут быть расшифрованы. Это принципиальное ограничение системы безопасности.

- **Хранение словаря**: ответственность за сохранность словаря лежит на пользователе. Рекомендуется хранить словарь отдельно от токенизированной таблицы и использовать надёжные методы хранения.

- **Передача словаря**: словарь следует передавать только доверенным лицам, которым необходимо выполнить детокенизацию. Не рекомендуется отправлять словарь вместе с токенизированной таблицей на обработку внешним системам.

### Применимость для персональных данных

Сервис подходит для работы с персональными и чувствительными данными при условии соблюдения пользователем рекомендаций по безопасности, в частности, надёжного хранения словаря токенов.

**Примечание**: формулировки о безопасности носят информационный характер и описывают практические аспекты работы сервиса. Пользователь несёт ответственность за соблюдение применимого законодательства при работе с персональными данными.

---

## Поддерживаемые форматы

### Импорт данных

Сервис поддерживает импорт данных только из файлов формата **Excel (XLSX)**.

**Поддерживается**:
- XLSX (Excel 2007 и новее)

**Не поддерживается**:
- CSV
- XLS (старый формат Excel)
- Другие форматы таблиц

### Экспорт данных

Сервис поддерживает экспорт токенизированных данных в следующих форматах:

- **XLSX** — формат Excel
- **CSV** — текстовый формат с разделителями (UTF-8 с BOM)
- **JSON** — словарь токенов в формате JSON

---

## Функциональные возможности

### Загрузка и просмотр данных

- **Загрузка Excel-файла**: загрузка файла формата XLSX через интерфейс браузера
- **Выбор листа**: при наличии нескольких листов в файле можно выбрать нужный лист для работы
- **Просмотр таблицы**: отображение таблицы в браузере с возможностью просмотра исходных данных, токенизированных данных или обоих вариантов одновременно

### Токенизация данных

- **Токенизация выбранных столбцов**: выбор одного или нескольких столбцов для токенизации с помощью чекбоксов. Все значения в выбранных столбцах заменяются на токены.

- **Токенизация отдельных значений**: возможность токенизировать отдельные ячейки в таблице. При токенизации ячейки все ячейки в том же столбце с таким же значением также получают тот же токен.

- **Работа с диапазонами строк**: установка маркера начала и конца токенизации для ограничения диапазона строк, в которых выполняется токенизация. Строки вне диапазона остаются без изменений.

- **Единая токенизация одинаковых значений**: одинаковые значения в столбце получают одинаковый токен. Это обеспечивает сохранение связей между данными при сохранении анонимности.

### Экспорт результатов

- **Экспорт токенизированной таблицы**: экспорт таблицы с токенизированными данными в форматах XLSX или CSV. Столбцы, не выбранные для токенизации, остаются без изменений.

- **Экспорт словаря токенов**: экспорт словаря соответствий токенов и исходных значений в формате JSON. Имя файла словаря содержит тот же идентификатор экспорта, что и имя файла таблицы, для удобного сопоставления.

- **Экспорт комплекта файлов**: возможность экспорта таблицы и словаря в одном ZIP-архиве.

### Импорт словаря и детокенизация

- **Импорт словаря**: загрузка сохранённого JSON-словаря для использования в процессе детокенизации.

- **Детокенизация ответов ИИ**: автоматическое распознавание токенов в тексте ответа системы искусственного интеллекта и замена их на исходные значения согласно словарю. Сервис находит все токены вида `[[...]]` в тексте и заменяет их на соответствующие исходные значения.

- **Статистика детокенизации**: отображение информации о количестве найденных токенов, количестве успешно распознанных токенов и количестве токенов, не найденных в словаре.

---

## Типовой сценарий использования

### Шаг 1: Загрузка Excel-файла

Пользователь загружает Excel-файл (XLSX) через интерфейс сервиса. Если в файле несколько листов, выбирает нужный лист для работы. Таблица отображается в браузере.

### Шаг 2: Токенизация данных

Пользователь выбирает столбцы, которые необходимо токенизировать (например, столбцы с ФИО, адресами, номерами документов). При необходимости устанавливает диапазон строк для токенизации. Нажимает кнопку токенизации. Значения в выбранных столбцах заменяются на токены.

### Шаг 3: Экспорт токенизированной таблицы и словаря

Пользователь экспортирует токенизированную таблицу в формате XLSX или CSV. Одновременно экспортирует JSON-словарь с соответствиями токенов и исходных значений. Оба файла получают одинаковый идентификатор экспорта в имени для удобного сопоставления.

### Шаг 4: Передача данных в систему ИИ

Пользователь передаёт токенизированную таблицу на обработку системе искусственного интеллекта или другому внешнему сервису. Словарь токенов остаётся у пользователя и не передаётся вместе с таблицей.

### Шаг 5: Получение ответа от системы ИИ

Пользователь получает ответ от системы ИИ, который может содержать токены вида `[[...]]`, ссылающиеся на данные из исходной таблицы.

### Шаг 6: Детокенизация ответа

Пользователь загружает сохранённый JSON-словарь в раздел детокенизации сервиса. Вставляет текст ответа системы ИИ в поле для обработки. Сервис автоматически находит все токены в тексте и заменяет их на исходные значения согласно словарю. Пользователь получает восстановленный текст с исходными данными вместо токенов.

---

## Ограничения и ответственность

### Предоставление сервиса

Сервис предоставляется "как есть", без гарантий любого рода, явных или подразумеваемых.

### Ответственность за словарь

Ответственность за сохранность словаря токенов полностью лежит на пользователе. Без словаря восстановление данных из токенов невозможно. Пользователь несёт ответственность за:

- Создание резервных копий словаря
- Надёжное хранение словаря
- Ограничение доступа к словарю
- Правильное сопоставление словаря с соответствующей токенизированной таблицей

### Невозможность восстановления без словаря

Без словаря соответствий восстановление исходных данных из токенов практически невозможно. Это принципиальное ограничение системы безопасности, обеспечивающее защиту данных при отсутствии словаря у третьих лиц.

---

## Запуск и использование

### Требования

Сервис является статическим веб-приложением и не требует установки дополнительного программного обеспечения или настройки сервера.

**Требования к браузеру**:
- Современный браузер с поддержкой JavaScript ES6+
- Поддержка Web Crypto API (`crypto.getRandomValues`)
- Поддержка FileReader API
- Поддержка Blob API

### Запуск

**Вариант 1: Прямое открытие файла**

1. Скачайте или клонируйте репозиторий
2. Откройте файл `index.html` в браузере (двойной клик или через меню "Открыть файл")
3. Сервис готов к работе

**Вариант 2: Размещение на веб-сервере**

Сервис может быть размещён на любом статическом веб-хостинге, включая GitHub Pages, без необходимости настройки серверной части. Достаточно загрузить файлы проекта на хостинг и открыть `index.html` через веб-сервер.

**Примечание**: для большинства современных браузеров вариант 1 (прямое открытие файла) работает без проблем. В некоторых случаях может потребоваться локальный веб-сервер из-за политики CORS браузера.

---

## Структура проекта

Проект состоит из следующих основных файлов:

- **index.html** — основной HTML-файл с интерфейсом приложения
- **app.js** — логика приложения, включая функции токенизации, детокенизации, экспорта и импорта
- **styles.css** — стили интерфейса
- **xlsx.full.min.js** — библиотека SheetJS для работы с Excel-файлами (включена в проект)

Дополнительные файлы:
- **README.md** — документация проекта (данный файл)

Все файлы необходимы для корректной работы сервиса. Библиотека SheetJS включена в проект и не требует отдельной установки.

---

## Чего делать нельзя

### Хранение словаря

- **Не храните словарь в небезопасных местах**: словарь содержит соответствия токенов и исходных данных. Хранение словаря в общедоступных местах, на незащищённых серверах или в облачных хранилищах без шифрования может привести к компрометации данных.

- **Не передавайте словарь третьим лицам без необходимости**: словарь следует передавать только тем, кому необходимо выполнить детокенизацию. Передача словаря вместе с токенизированной таблицей на обработку внешним системам не рекомендуется.

### Понимание токенизации

- **Не считайте токены за шифрование без словаря**: токенизация — это псевдоанонимизация, а не необратимое шифрование. При наличии словаря данные полностью восстанавливаются. Безопасность обеспечивается отсутствием словаря у третьих лиц, а не криптографической стойкостью токенов самих по себе.

### Работа с токенами

- **Не изменяйте токены в ответах ИИ**: токены в ответах систем искусственного интеллекта должны оставаться неизменными. Любое изменение токена (замена символов, изменение регистра, добавление пробелов) приведёт к тому, что токен не будет найден в словаре, и детокенизация не произойдёт.

- **Не разрывайте токены**: токен вида `[[...]]` должен оставаться целым. Нельзя вставлять пробелы, переносы строк или другие символы внутри токена или между его частями.

---

## Заключение

Anonimizator предоставляет инструмент для безопасной псевдоанонимизации Excel-таблиц с возможностью последующего восстановления данных по словарю. Сервис работает полностью локально в браузере пользователя, не требует регистрации и не передаёт данные на сервер.

Эффективность и безопасность использования сервиса зависят от соблюдения пользователем рекомендаций по работе со словарём токенов и понимания принципов псевдоанонимизации.

---

**Версия документации**: 1.0
